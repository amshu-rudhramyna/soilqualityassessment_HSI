# Soil Quality Assessment using Hyperspectral Imaging: Baseline Model

## Project Overview

This project aims to develop a baseline model for soil quality assessment using hyperspectral imaging. The current implementation focuses on establishing a robust engineering pipeline for data generation, preprocessing, and model training/evaluation, using synthetic data due to temporary unavailability of real datasets.

## Technical Infrastructure

*   **Environment:** Python environment (`hypersoil`) on Windows.
*   **Hardware Acceleration:** PyTorch and XGBoost are linked to an RTX 3070 GPU (CUDA 12.1).
*   **Key Libraries:** `rasterio`, `spectral`, `eotdl`, `numpy`, `scipy`, `scikit-learn`.

## Code Pipeline

The project implements a "Sim-to-Real" pipeline, mimicking research paper methodology:

1.  **`generate_mock_data.py`:** Generates synthetic hyperspectral cubes (150 bands, 11x11 pixels) for testing the system when real data is unavailable.
2.  **`baseline_model.py`:** The core script that:
    *   Loads `.npz` data.
    *   Preprocesses signals (Savitzky-Golay smoothing and spatial averaging).
    *   Trains a `RandomForestRegressor` and a `PLSRegression` model.
    *   Outputs R2 scores and saves the trained models (`.pkl`).

## Current Data Status

*   **Real Data:** The EOTDL server is currently inaccessible (returning `404/403` errors).
*   **Solution:** Mock data generated by `generate_mock_data.py` is used to prove the system functionality. The code is designed to seamlessly integrate real data once access is granted.

## Setup and Running the Project

### Prerequisites

*   Python 3.10 (within the `hypersoil` conda environment).
*   Required Python packages (installed via `pip`).

### Installation

1.  **Clone the repository** (once it's pushed).
2.  **Navigate to the project directory**: `cd hypersoil` (or your project root).
3.  **Create and activate the conda environment**: (Assuming you have Anaconda/Miniconda installed)
    ```bash
    conda create -n hypersoil python=3.10
    conda activate hypersoil
    ```
4.  **Install dependencies**:
    ```bash
    pip install numpy scipy scikit-learn
    ```

### Generating Mock Data

To generate the synthetic dataset:

```bash
python generate_mock_data.py
```

This will create `dataset/HYPERVIEW2/mock_data.npz`.

### Running the Baseline Model

To train and evaluate the baseline models (Random Forest and PLSR):

```bash
python baseline_model.py
```

This will output the R2 scores for each nutrient (P, K, Mg, pH) and save the trained models in the `models/` directory.

## Current Progress Summary (from `context.txt`)

*   **Initial Understanding:** The task was initiated based on the requirements outlined in `PROMPT.txt`. The goal is to develop a baseline model (PLSR or Random Forest) for hyperspectral soil image data.
*   **Mock Data Generation:**
    *   Created `generate_mock_data.py` to synthesize hyperspectral cubes (200 samples, 150 bands, 11x11 pixels) and corresponding nutrient levels (P, K, Mg, pH).
    *   Successfully executed `generate_mock_data.py`, saving `mock_data.npz` to `dataset/HYPERVIEW2/`. This serves as a placeholder until real data from EOTDL is accessible.
*   **Baseline Model Implementation (Random Forest & PLSR):**
    *   Developed `baseline_model.py` to:
        *   Load the `mock_data.npz`.
        *   Preprocess hyperspectral data using Savitzky-Golay smoothing and spatial averaging (11x11 pixels).
        *   Train and evaluate `RandomForestRegressor` models for each nutrient (P, K, Mg, pH).
        *   Train and evaluate `PLSRegression` models for each nutrient (P, K, Mg, pH).
        *   Report R2 scores for each model.
        *   Save trained models as `.pkl` files in a new `models/` directory.
*   **Dependency Management:**
    *   Installed `scipy` using `pip install scipy` to enable Savitzky-Golay filtering.
    *   Installed `scikit-learn` using `pip install scikit-learn` to utilize Random Forest and PLS Regression models.
*   **Model Execution and Results:**
    *   Successfully ran `baseline_model.py`.
    *   Observed negative R2 scores for all models, which is expected given the use of randomly generated mock data. This confirms the pipeline functionality with synthetic inputs.
    *   Random Forest and PLS models for P, K, Mg, and pH were saved to their respective `.pkl` files in the `models/` directory.

## Next Steps

The next step is to obtain actual hyperspectral soil data to train and validate the models. Further improvements and adjustments can be made based on the insights from the `HyperSoilNet.pdf` document, which currently requires its content to be provided in a text-readable format.
